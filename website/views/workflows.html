<!DOCTYPE html>
<html>
<head>
    <title>n8n Workflows</title>
    <link rel="stylesheet" href="../css/styles.css">
    <script src="../js/config.js"></script>
</head>
<body>
    <h1>n8n Workflows</h1>
    <div class="menu">
        <a href="index.html">Home</a>
        <a href="chat.html">Chat</a>
        <a href="workflows.html">Workflows</a>
    </div>
    <div>
        <p>Access the n8n interface directly through the link below:</p>
        <a href="/n8n/" target="_blank">Open n8n Interface</a>
    </div>
    <div id="workflows-list"></div>

    <script>
        async function loadWorkflows() {
            try {
                const response = await fetch('/n8n/rest/workflows', {
                    headers: {
                        'Accept': 'application/json'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const workflowsList = document.getElementById('workflows-list');
                    
                    if (data && data.data && data.data.length > 0) {
                        const ul = document.createElement('ul');
                        
                        data.data.forEach(workflow => {
                            const li = document.createElement('li');
                            li.innerHTML = `<strong>${workflow.name}</strong> - ${workflow.active ? 'Active' : 'Inactive'}`;
                            ul.appendChild(li);
                        });
                        
                        workflowsList.appendChild(ul);
                    } else {
                        workflowsList.innerHTML = '<p>No workflows found or you need to authenticate first.</p>';
                    }
                } else {
                    document.getElementById('workflows-list').innerHTML = 
                        '<p>Error fetching workflows. You may need to authenticate first.</p>';
                }
            } catch (error) {
                document.getElementById('workflows-list').innerHTML = 
                    '<p>Error: ' + error.message + '</p>';
            }
        }
        
        // Load workflows when page loads
        window.addEventListener('load', loadWorkflows);
    </script>
</body>
</html>
